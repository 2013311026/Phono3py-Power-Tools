# phonopy-get-trans-mat


`phonopy-get-trans-mat` compares two VASP POSCAR files specifying conventional and primitive cells and calculates the transformation matrix to map between them.


## Installation and requirements

No installation is necessary.
For ease of use on Unix(-like) systems, you may wish to add the scripts folder to your `$PATH` variable - e.g.:

```bash
export PATH=${PATH}:/mnt/d/Repositories/Phono3py-Power-Tools
```

`phonopy-get-trans-mat` requires the [NumPy](https://numpy.org) package.


## Usage example

This script was written for comparing the conventional ("Bravais") and primitive cells obtained using `phonopy --symmetry`.

This run mode writes the conventional and primitive cells to `BPOSCAR` and `PPOSCAR` files, respectively.
At present, however, it does not print out the transformation matrix required to use (a supercell of) the conventional cell for the force calculations and perform our analysis using the primitive cell.

For example, for *Cmcm* SnSe we obtain the following cells:

```
$ cat BPOSCAR
generated by phonopy
   1.0
     4.2173291699446942    0.0000000000000000    0.0000000000000000
     0.0000000000000000   11.5250329339873883    0.0000000000000000
     0.0000000000000000    0.0000000000000000    4.2043122886624822
Se Sn
   4    4
Direct
  0.0000000000000000  0.3587003526619201  0.7500000000000000
  0.5000000000000000  0.1412996473380799  0.2500000000000000
  0.5000000000000000  0.8587003526619201  0.7500000000000000
  0.0000000000000000  0.6412996473380799  0.2500000000000000
  0.0000000000000000  0.1223778203837185  0.7500000000000000
  0.5000000000000000  0.3776221796162815  0.2500000000000000
  0.5000000000000000  0.6223778203837185  0.7500000000000000
  0.0000000000000000  0.8776221796162815  0.2500000000000000
```

```
$ cat PPOSCAR
generated by phonopy
   1.0
     2.1086645849723471   -5.7625164669936941    0.0000000000000000
     2.1086645849723471    5.7625164669936941    0.0000000000000000
     0.0000000000000000    0.0000000000000000    4.2043122886624822
Se Sn
   2    2
Direct
  0.6412996473380801  0.3587003526619200  0.2500000000000000
  0.3587003526619199  0.6412996473380801  0.7500000000000000
  0.8776221796162815  0.1223778203837184  0.2500000000000000
  0.1223778203837184  0.8776221796162815  0.7500000000000000
```

To determine the transformation matrix, we can use `phonopy-get-trans-mat` as follows:

```
$ phonopy-get-trans-mat BPOSCAR PPOSCAR
Conventional cell:
------------------
  a = [    4.21733     0.00000     0.00000 ]
  b = [    0.00000    11.52503     0.00000 ]
  c = [    0.00000     0.00000     4.20431 ]

Primitive cell:
---------------
  a = [    2.10866    -5.76252     0.00000 ]
  b = [    2.10866     5.76252     0.00000 ]
  c = [    0.00000     0.00000     4.20431 ]

Transformation M_p:
-------------------
  [  0.500   0.500   0.000 ]
  [ -0.500   0.500   0.000 ]
  [  0.000   0.000   1.000 ]

Inverse transformation M_p ^ -1:
--------------------------------
  [  1  -1   0 ]
  [  1   1   0 ]
  [  0   0   1 ]

To input this information into Phono(3)py:
------------------------------------------
  --pa="0.500 0.500 0.000  -0.500 0.500 0.000  0.000 0.000 1.000"
```

If the transformation matrix is determined successfully, the script prints it to the command line along with the `--pa` tag needed to input it into Phono(3)py.
